<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <link rel="apple-touch-icon" sizes="57x57" href="./Asset/img/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="./Asset/img/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./Asset/img/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="./Asset/img/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="./Asset/img/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./Asset/img/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./Asset/img/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./Asset/img/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./Asset/img/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="./Asset/img/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./Asset/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="./Asset/img/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./Asset/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="./Asset/img/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="Asset/css/style.css">
    <title>5B | Registro Conéctate</title>
  </head>
  <body>
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/es_ES/sdk.js#xfbml=1&version=v3.3&appId=378526666182086&autoLogAppEvents=1"></script>
    <div class="row h-100">
        
        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 h-100 d-flex">
            <div class="w-70 text-left m-auto ">
                <img class="w-90" src="./Asset/img/Somos.png">
                <img class="w-90" src="./Asset/img/Logo Influmedia.png">
                <br>
                <p class="text-white text-somos">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Quis ipsum suspendisse ultrices gravida. Risus commodo viverra maecenas accumsan lacus vel facilisis.</p>
            </div>
        </div>
        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 h-100 d-flex">
            <div class="w-75 text-center m-auto ">
                  <img id="login" class="w-90 m-auto pointerpointerpointer" src="./Asset/img/LoginFB.png">
                <p class="text-left text-white texto-login">
                    Regístrate con Facebook para continuar con la validación de tu código además podrás ganar un premio sorpresa.
                </p>
            </div>
        </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="./Asset/js/main.js"></script>
    <script src="./Asset/js/events.js"></script>
    <script>
    // Load the SDK asynchronously
    (function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          js.src = "//connect.facebook.net/en_US/sdk.js";
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
        $(function() {

var app_id = '378526666182086';
var scopes = 'email, user_friends, user_online_presence';

var btn_login = '<a href="#" id="login" class="btn btn-primary">Iniciar sesión</a>';

var div_session = "<div class='text-center text-light' id='facebook-session'>"+
          "<strong class='p-3'></strong><br>"+
          "<img class='m-auto'><br>"+
          "<a href='#' id='logout' class='btn btn-danger mt-3 p-2'>Cerrar sesión</a>"+
          "</div>";
// Inicio de api
  window.fbAsyncInit = function() {
    FB.init({
      appId      : app_id,
      status     : true,
      cookie     : true, 
      xfbml      : true, 
      version    : 'v2.1'
    });
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response, function() {});
    });
  };
  var statusChangeCallback = function(response, callback) {
    if (response.status === 'connected') {
        getFacebookData();
    } else {
       callback(false);
    }
  }
  var checkLoginState = function(callback) {
    FB.getLoginStatus(function(response) {
        callback(response);
    });
  }

  var getFacebookData =  function() {
    FB.api('/me', function(response) {
      $('#login').after(div_session);
      $('#login').remove();
      $('#facebook-session strong').text("Bienvenido: "+response.name+"\n");
      $('#facebook-session img').attr('src','http://graph.facebook.com/'+response.id+'/picture?type=large');
    });
  }

  var facebookLogin = function() {
    checkLoginState(function(data) {
      if (data.status !== 'connected') {
        FB.login(function(response) {
          if (response.status === 'connected')
            getFacebookData();
        }, {scope: scopes});
      }else{
        getFacebookData();

      }
    })
  }

  var facebookLogout = function() {
    checkLoginState(function(data) {
      if (data.status === 'connected') {
        FB.logout(function(response) {
        $('#facebook-session').before(btn_login);
        $('#facebook-session').remove();
      })
    }
    })

  }

  $(document).on('click', '#login', function(e) {
    e.preventDefault();

    facebookLogin();
  })
})
    </script>
  </body>
</html>